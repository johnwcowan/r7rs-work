<h1>Specification</h1>
<a name="node_sec_3.1"></a>
<h2><a href="#node_toc_node_sec_3.1">3.1&nbsp;&nbsp;Errors</a></h2>
<p>This SRFI's procedures never return error codes, and do not use a global
<code>errno</code> variable to report errors.
Errors are consistently reported by raising exceptions.
In addition, this SRFI requires that no error
based on the error code EINTR is ever raised.  Instead, the system call
that failed is retried.  This means that if a system call is interrupted
because a signal was received by the process, the system call will be
automatically retried, thus eliminating what is traditionally known as
<a href="https://www.dreamsongs.com/RiseOfWorseIsBetter.html">
the PC loser-ing problem<a/>.
The canonical set of P<small>OSIX</small> calls mentioned below that
can result in EINTR are <code>chmod</code>, <code>chown</code>,
<code>close</code>, <code>getpwnam</code>, <code>getpwuid</code>,
<code>getgrnam</code>, <code>getgruid</code>, and <code>truncate</code>.
</p><p>
This frees up the procedures to return useful values,
and allows the programmer to assume that
<i>if a procedure returns, it succeeded.</i>
This greatly simplifies the flow of the code from the programmer's point
of view.
</p><p>
For reference purposes, the P<small>OSIX</small> <code>errno</code> numbers
are bound to the variables <code>errno/perm</code>, <code>errno/noent</code>, etc.
See <a href="http://pubs.opengroup.org/onlinepubs/9699919799/basedefs/errno.h.html">
the P<small>OSIX</small> specification of <code>errno.h</code></a> for the complete
list, and note at the bottom "XSH Error Numbers", that link provides explanations
about each error.

<p>
</p>
<p></p>
<p></p>
<p></p>
<div align="left"><code>(errno-error <i>errno procname . data</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>never returns</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;</div>
<blockquote>
Raises a non-continuable exception for P<small>OSIX</small> error number <i>errno</i>.
The <i>procname</i> argument is a string representing the name of the procedure
which received the error, which is not necessarily the procedure called by the user.
The <i>procname</i> and <i>data</i> arguments are packaged up in the exception
packet passed to the exception handler.
It is an error to pass an <code>errno</code> that is not provided by the OS.</p>
</blockquote><p>
</p>
<div align="left"><code>(syscall-error? <i>obj</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>boolean</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;</div>
<blockquote>
  Returns <code>#t</code> if <i>obj</i> is an object created by a call to <code>errno-error</code>
  or one of an implementation-defined set of other objects, and <code>#f</code> otherwise.
</blockquote><p>
</p>
<div align="left"><code>(syscall-error:errno <i>syscall-error</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>exact integer</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P<small>OSIX</small> <code>errno</code>&nbsp;</div>
<div align="left"><code>(syscall-error:message <i>syscall-error</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>string</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; P<small>OSIX</small> <code>strerror()</code>&nbsp;</div>
<div align="left"><code>(syscall-error:procname <i>syscall-error</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>string</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;</div>
<div align="left"><code>(syscall-error:data <i>syscall-error</i>)</code> &nbsp;&nbsp;&nbsp;&rarr; &nbsp;&nbsp;&nbsp;<i><i>list</i></i> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(procedure)&nbsp;</div>
<blockquote>
  Returns a value equal to the Posix error number,
  the corresponding error message,
  the procedure name passed to <code>errno-error</code>,
  and  a list containing the data packaged in in the <i>syscall-error</i> object respectively.
  All of these, with the possible exception of the error message, are
  packaged in the <i>syscall-error</i> object.
  It is an error to mutate the values returned by any of these procedures.
</blockquote><p>
</p>
<h1>Implementation</h1>

<h2><a href="#node_imp_node_sec_3.1">3.1&nbsp;&nbsp;Errors</a></h2>
<ul>
<li><p>
  Scsh defines the procedure <code>syscall-error?</code> but unfortunately does not expose it.
  A syscall-error object in scsh is a list whose second, third, and fourth elements
  are the errno, the error message, and the procedure respectively,
  and whose remaining elements (if any) are the data passed to <code>errno-error</code>.
  Therefore, the procedures <code>syscall-error:errno</code>, <code>syscall-error:message</code>,
  <code>syscall-error:procedure</code>, and <code>syscall-error:data</code> can be defined as
  <code>cadr</code>, <code>caddr</code>, <code>cadddr</code>, and <code>cddddr</code> respectively.
</p></li>
<li><p>
It's likely that not all of the error and signal numbers supported
by P<small>OSIX</small> are available in scsh.
</p></li>
</ul>

